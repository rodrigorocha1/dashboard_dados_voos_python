CREATE DATABASE DADOS_VOO;

CREATE EXTERNAL TABLE EXPLORACAO_FAIXA_ATRASO_PARTIDA (
    NUMERO_VOO INT,
    NOME_AEROPORTO_ORIGEM STRING,
    CIDADE_AEROPORTO_ORIGEM STRING,
    NOME_EMPRESA STRING,
    NOME_MES_PARTIDA_REAL STRING,
    MINUTOS_ATRASADO_PARTIDA FLOAT,
    DIA_DA_SEMANA_PARTIDA_PREVISTA STRING,
    TOTAL_OCORRENCIAS INT    
    
)
PARTITIONED BY (
    CODIGO_TIPO_LINHA VARCHAR(1),
    MES_PARTIDA_REAL TINYINT,
    INDICE_SEMANA_PARTIDA_REAL TINYINT,
    FIM_DE_SEMANA_PARTIDA_REAL BOOLEAN,
    UF_AEROPORTO_ORIGEM VARCHAR(2),
    SIGLA_ICAO_AEROPORTO_ORIGEM VARCHAR(15),
    SIGLA_ICAO_EMPRESA_AEREA VARCHAR(25),
    FAIXA_ATRASO_PARTIDA STRING
)

STORED AS ORC;






SELECT *
FROM exploracao_faixa_atraso_partida 
where sigla_icao_empresa_aerea = 'AZU';

SELECT *
from exploracao_faixa_atraso_chegada efac ;


DESCRIBE FORMATTED exploracao_faixa_atraso_partida;

DROP DATABASE dados_voos;
SHOW PARTITIONS exploracao_faixa_atraso_partida;

